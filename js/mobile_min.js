!function(){var a=/(.)^/,b={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},c=/\\|'|\r|\n|\t|\u2028|\u2029/g;window._Template=function(d,e){var f,g=_Template.settings,h=new RegExp([(g.escape||a).source,(g.interpolate||a).source,(g.evaluate||a).source].join("|")+"|$","g"),i=0,j="__p+='";d.replace(h,function(a,e,f,g,h){return j+=d.slice(i,h).replace(c,function(a){return"\\"+b[a]}),e&&(j+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),f&&(j+="'+\n((__t=("+f+"))==null?'':__t)+\n'"),g&&(j+="';\n"+g+"\n__p+='"),i=h+a.length,a}),j+="';\n",g.variable||(j="with(obj||{}){\n"+j+"}\n"),j="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+j+"return __p;\n";try{f=new Function(g.variable||"obj","_",j)}catch(a){throw a.source=j,a}if(e){var k="";try{k=f(e)}catch(a){for(var l=["Can't find variable: "," is not defined"," is undefined","'"],m=a.message,n=0,o=l.length;n<o;n++)m=m.replace(l[n],"");console.log("varName",m),e[m]=!1,k=f(e)}return k}var p=function(a){return f.call(this,a)};return p.source="function("+(g.variable||"obj")+"){\n"+j+"}",p},window._Template.settings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g}}(),NaviMobile=function(a,b){function c(){function a(){o||(o=!0)}if(!j||!l)return void setTimeout(c,100);l.sections.shift(),console.log("data",l);var b=_Template(j,l);document.body.insertAdjacentHTML("beforeend",b);var g=Modernizr.touch?"touchend":"click";document.getElementById("open-menu-btn").addEventListener(g,d),document.getElementById("plus-btn").addEventListener(g,e),document.getElementById("nav-home-btn").addEventListener(g,window.open,"#/","_self");var i=document.getElementById("nav-contact");if(i.href="",i.addEventListener(g,function(a){a.preventDefault(),e(a)}),n=document.getElementsByClassName("nav-item"),Modernizr.touch)for(var k=0,p=n.length;k<p;k++)"nav-contact"!=n[k].id&&h(n[k],f);else for(var k=0,p=n.length;k<p;k++)"nav-contact"!=n[k].id&&n[k].addEventListener("click",f);m=new FJ.CSSTransformBehavior(document.getElementById("side-nav"),{div:document.getElementById("side-nav")}),c=a,a()}function d(a){a.stopPropagation(),a.preventDefault();var b=Modernizr.touch?"touchstart":"click";if(document.body.classList.contains("side-nav-open"))q.target(),document.body.classList.remove("side-nav-open"),g(),new FJ.Notification(Tool.Actions.SIDENAV,Tool.Actions.HIDE).send(),document.querySelector("#rootView").removeEventListener(b,d),setTimeout(function(){document.body.style.backgroundColor=p},400);else{var c=document.querySelector("#nav-home-btn");c.style.pointerEvents="none",setTimeout(function(){c.style.pointerEvents="all"},1e3),document.body.classList.add("side-nav-open"),new FJ.Notification(Tool.Actions.SIDENAV,Tool.Actions.SHOW).send(),q.target(m),p=document.body.style.backgroundColor,document.body.style.backgroundColor="white",document.querySelector("#rootView").addEventListener(b,d)}}function e(){document.body.classList.contains("contact")?new FJ.Notification(Tool.Actions.V_CNT,Tool.Actions.HIDE).send():new FJ.Notification(Tool.Actions.V_CNT,Tool.Actions.SHOW).send()}function f(a){i(a.currentTarget||a.target);var b=a.target.nextElementSibling;if(b&&b.classList.contains("accordion")){var c=b.classList.contains("open");g(),c?(i(),b.classList.add("closed")):(b.classList.remove("closed"),b.classList.add("open"))}}function g(){for(var a=document.getElementsByClassName("accordion"),b=0,c=a.length;b<c;b++)a[b].classList.remove("open"),a[b].classList.add("closed")}function h(a,b){var c;a.addEventListener("touchstart",function(a){var d=a.currentTarget;c=setTimeout(function(){b({target:d})},200)}),a.addEventListener("touchmove",function(){clearTimeout(c)})}function i(a){if(!a||"nav-blog"!=a.id){for(var b=0,c=n.length;b<c;b++)n[b].classList.remove("selected");a&&a.classList.add("selected")}}var j,k,l,m,n,o=!1,p="white",q=ScrollController;setTimeout(function(){BaseView.requestData(a,Tool.Actions.V_NAVI,Tool.Actions.DT_INIT),FJ.Loader.loadPlainText(Tool.Actions.TP_NAVI_MOBILE,function(a){j=a||j})},1),k=new ViewState(a,-1,-1,null,function(b){return b.head==a&&b.isHeadOnly()}),FJ.Application.createMediator().update=function(b){switch(b.message){case FJ.MSG_NAVIGATE:k.onNavigation(b.slug),document.body.classList.contains("side-nav-open")&&(document.body.classList.remove("side-nav-open"),Modernizr.touch?document.querySelector("#rootView").removeEventListener("touchstart",d):document.querySelector("#rootView").removeEventListener("click",d)),c(),g();break;case Tool.Actions.MSG_RESIZE:k.onResize();break;case Tool.Actions.V_CNT:b.type==Tool.Actions.SHOW&&document.querySelector("#rootView").removeEventListener(Modernizr.touch?"touchstart":"click",d);break;case Tool.Actions.MSG_ON_DATA_LOADED:b.vars.dataId==a&&(l=FJ.Application.model.data[a])}}},AboutMobile=function(a,b){function c(){g.div.classList.remove("visible"),g.hide()}function d(a){var b;if(void 0!=a?(a.preventDefault(),b=a.currentTarget.getAttribute("href").split("/")[2]):b=f.lastSlug.parts[1],b){var c=document.getElementById(b);h.scrollTo(0,c.offsetTop/ScrollController.getScrollSpeed())}}var e,f,g=new FJ.View(b),h=ScrollController;g.id(a+"-mobile"),f=new ViewState(a,-1,-1,g,function(b){return b.head==a}),FJ.Application.createMediator().update=function(b){switch(b.message){case FJ.MSG_NAVIGATE:f.onNavigation(b.slug),f.isVisible()?i():c();break;case Tool.Actions.MSG_RESIZE:f.onResize();break;case Tool.Actions.V_CNT:case Tool.Actions.SIDENAV:b.type==Tool.Actions.HIDE&&f.isVisible()&&h.target(g);break;case Tool.Actions.MSG_ON_DATA_LOADED:(b.vars.dataId==a||b.vars.dataId==Tool.Actions.V_AWD&&f.isVisible())&&i()}};var i=function(){if(h.target(g),GlobalBackground.setColor("#000"),b.style.color="white",!BaseView.requestData(a,Tool.Actions.V_ABT,Tool.Actions.DT_ABOUT_MOBILE)){if(!e)return void FJ.Loader.loadPlainText(Tool.Actions.TP_ABOUT_MOBILE,function(a){e=a,i()});var c=FJ.Application.model.data[a];c.projects={liveAction:[{header:"Commercial",items:[{name:"Picture",client:"Help",img:"assets/imgs/about/thumbs/live-action/commercial/picture-480.jpg",url:"#/work/picture"},{name:"Gaspocalypse",client:"Hyundai",img:"assets/imgs/about/thumbs/live-action/commercial/gasopoclypse-480.jpg",url:"#/work/gaspocalypse"},{name:"Security",client:"Kohl's",img:"assets/imgs/about/thumbs/live-action/commercial/security-480.jpg",url:"#/work/just-another-day-at-the-office-for-jennifer-lopez"}]},{header:"Branded Content",items:[{name:"Mandible",client:"NBFF",img:"assets/imgs/about/thumbs/live-action/branded/mandable-480.jpg",url:"#/work/mandible"},{name:"Welcome to the new Normal",client:"Mitsubishi",img:"assets/imgs/about/thumbs/live-action/branded/normal-480.jpg",url:"#/work/welcome-to-the-new-normal"},{name:"Clouds Over Cuba",client:"JFK Presidential Library",img:"assets/imgs/about/thumbs/live-action/branded/clouds-480.jpg",url:"#/work/"}]},{header:"Promos",items:[{name:"Star Trek",client:"ESPN",img:"assets/imgs/about/thumbs/live-action/promos/startrek-480.jpg",url:"#/work/star-trek"},{name:"Cliff",client:"ESPN",img:"assets/imgs/about/thumbs/live-action/promos/gijoe-480.jpg",url:"#/work/cliff"},{name:"Muse",client:"NBFF",img:"assets/imgs/about/thumbs/live-action/promos/muse-480.jpg",url:"#/work/muse"}]},{header:"Music Videos",items:[{name:"fjogur piano",client:"Sigur Ros",img:"assets/imgs/about/thumbs/live-action/musicvideos/siguros-480.jpg",url:"#/work/fjogur-piano"},{name:"Lost in the echo",client:"linkin park",img:"assets/imgs/about/thumbs/live-action/musicvideos/linkinpark-480.jpg",url:"#/work/lost-in-the-echo-2"},{name:"I've Seen Enough",client:"Cold War Kids",img:"assets/imgs/about/thumbs/live-action/musicvideos/coldwarkids-480.jpg",url:"#/work/ive-seen-enough"}]}],digital:{header:"digital",items:[{header:"Integrated",name:"Clouds Over Cuba",client:"JFK Presidential Library",img:"assets/imgs/about/thumbs/digital/integrated/cloudsovercuba-480.jpg",url:"#/work/clouds-over-cuba"},{header:"HTML5",name:"Rectify",client:"Sundance Channel",img:"assets/imgs/about/thumbs/digital/html/rectify-480.jpg",url:"#/work/rectify"},{header:"Mobile",name:"Lexus Tori 500",client:"Lexus",img:"assets/imgs/about/thumbs/digital/mobile/tori-480.jpg",url:"#/work/tori-500-ios-app"},{header:"Social",name:"HELP i have the Flu",client:"Help remedies",img:"assets/imgs/about/thumbs/digital/social/help-480.jpg",url:"#/work/help-i-have-the-flu"}]},post:{header:"Post-Production",items:[{name:"Unpretentious",client:"Mitsubishi",img:"assets/imgs/about/thumbs/post/mits-pret-480.jpg",url:"#/work/unpretentious"},{name:"Only The Name Remains",client:"Toyota",img:"assets/imgs/about/thumbs/post/avalon-480.jpg",url:"#/work/only-the-name-remains"},{name:"Lost In The Echo",client:"Linkin Park",img:"assets/imgs/about/thumbs/post/linkinPark-480.jpg",url:"#/work/lost-in-the-echo-2"},{name:"Good Reasons",client:"Honda",img:"assets/imgs/about/thumbs/post/goodReasons-480.jpg",url:"#/work/good-reasons"}]}},g.div.innerHTML=_Template(e,c),setTimeout(function(){g.div.classList.add("visible")},1),d();for(var f=g.div.querySelectorAll(".nav-item"),j=Modernizr.touch?"touchend":"click",k=0,l=f.length;k<l;k++)f[k].addEventListener(j,d);document.querySelector("#bottom-logo").addEventListener(j,function(){setTimeout(h.scrollTo,400,0,0,150)}),FJ.Loader.loadJSON(Tool.Actions.DT_AWARDS,function(a){console.log("awardsData",a);for(var b=a.featured.slice(0,3),c=document.querySelectorAll("#awards .award"),d=0,e=b.length;d<e;d++){var f=c[d].querySelectorAll("div");f[0].className="icon icon-"+b[d].type,f[1].innerHTML=b[d].amount}})}}},AwardsMobile=function(a,b){function c(a){a.type==Tool.Actions.HIDE&&i.isVisible()&&(n(),m.target(l),m.onscroll=e)}function d(){l.div.classList.remove("visible"),l.hide()}function e(a,b){if(a*m.getScrollSpeed()>b-200)for(var c=0,d=Math.min(4,k.length);c<d;c++)document.getElementById("projects").innerHTML+=_Template(g,k.shift())}var f,g,h,i,j,k=[],l=new FJ.View(b),m=ScrollController;l.id(a+"-mobile"),i=new ViewState(a,-1,-1,l,function(b){return b.parts[0]==a}),FJ.Application.createMediator().update=function(a){switch(a.message){case FJ.MSG_NAVIGATE:i.onNavigation(a.slug.split("/")[0]),i.isVisible()?(n(),m.target(l),m.onscroll=e):d();break;case Tool.Actions.MSG_RESIZE:i.onResize();break;case Tool.Actions.SIDENAV:case Tool.Actions.V_CNT:c(a);break;case Tool.Actions.MSG_ON_DATA_LOADED:i.isVisible()&&n()}};var n=function(){BaseView.requestData(a,Tool.Actions.V_AWD,Tool.Actions.DT_AWARDS)||(FJ.Loader.loadPlainText(Tool.Actions.TP_AWARDS_MOBILE,function(a){f=a,FJ.Loader.loadPlainText(Tool.Actions.TP_AWARDS_MOBILE_PROJECT,function(a){g=a,n()})}),n=function(){b.style.background="white",f&&g&&(j=FJ.Application.model.data[a],console.log("data",j),k=j.projects.concat([]),l.show(),l.div.innerHTML=_Template(f,j),h=document.getElementById("projects"),(n=function(){l.show(),l.div.classList.remove("visible"),setTimeout(function(){l.div.classList.add("visible")},1),e(0,100)})())})}},ConnectMobile=function(a,b){function c(){setTimeout(function(){GlobalBackground.setColor("white"),document.body.classList.add(a)},10)}function d(){if(console.log("show.show()",arguments),o.target(n),c(),!l||!k)return void setTimeout(d,1);c(),console.log("_data",l),GlobalBackground.setColor("white"),document.body.appendChild(n.div),n.div.innerHTML=_Template(k,l),m=!0,o.target(n);var a=n.div.querySelectorAll(".expandable header");if(Modernizr.touch)for(var b=0,f=a.length;b<f;b++)i(a[b],g);else for(var b=0,f=a.length;b<f;b++)a[b].addEventListener("click",g,!1);setTimeout(j,1e3),e(),h(),d=function(){GlobalBackground.setColor("white"),m=!0,document.body.appendChild(n.div),c(),setTimeout(function(){o.target(n)},100),e()}}function e(){Modernizr.touch?document.querySelector("#rootView").addEventListener("touchstart",f):document.querySelector("#rootView").addEventListener("click",f)}function f(b){b&&b.preventDefault(),m&&(m=!1,document.body.classList.remove(a),new FJ.Notification(Tool.Actions.V_CNT,Tool.Actions.HIDE).send(),setTimeout(function(){document.body.removeChild(n.div)},300),Modernizr.touch?document.querySelector("#rootView").removeEventListener("touchstart",f):document.querySelector("#rootView").removeEventListener("click",f))}function g(a){var b=a.currentTarget||a,c=Number(b.getAttribute("data-i")),d=document.getElementById("connectSec2").querySelectorAll("header")[c],e=d.offsetHeight*c+document.getElementById("connectSec2").offsetTop;b=b.parentNode,b=b.querySelector(".accordion");var f=b.classList.contains("open");h(),setTimeout(function(){f?(b.classList.add("closed"),b.style.height=0):(b.classList.remove("closed"),b.classList.add("open"),b.style.height=b.getAttribute("data-height")+"px"),setTimeout(function(){o.scrollTo(0,e/ScrollController.getScrollSpeed())},100),setTimeout(function(){b.style.pointerEvents="all"},1e3)},1)}function h(){for(var a=n.div.getElementsByClassName("accordion"),b=0,c=a.length;b<c;b++){if(a[b].classList.remove("open"),a[b].classList.add("closed"),!a[b].getAttribute("data-height")){for(var d=a[b].querySelectorAll(".contact"),e=80,f=0,g=d.length;f<g;f++)e+=d[f].offsetHeight;a[b].setAttribute("data-height",e)}a[b].style.pointerEvents="none",a[b].style.height=0}}function i(a,b){function c(){a.removeEventListener("touchmove",c),clearTimeout(d)}var d;a.addEventListener("touchstart",function(a){var e=a.currentTarget;d=setTimeout(function(){b(e)},200),e.addEventListener("touchmove",c)})}function j(){function a(a){var b=a.getAttribute("data-href");a.getAttribute("target");b.length>0&&setTimeout(function(){window.location.href=b},1)}for(var b=n.div.querySelectorAll("a"),c=0,d=b.length;c<d;c++)Modernizr.touch?i(b[c],a):b[c].addEventListener("click",function(b){a(b.currentTarget)})}var k,l,m=!1,n=new FJ.View(document.createElement("div")),o=ScrollController;n.id(a+"-mobile"),n.class("view");var p=new ViewState(a,-1,-1,n,function(b){return b.head==a});setTimeout(function(){BaseView.requestData(a,Tool.Actions.V_CNT,Tool.Actions.DT_CONNECT),FJ.Loader.loadPlainText(Tool.Actions.TP_CONNECT_MOBILE,function(a){k=a})},1),FJ.Application.createMediator().update=function(b){switch(b.message){case FJ.MSG_NAVIGATE:break;case Tool.Actions.V_CNT:b.type==Tool.Actions.SHOW?d():b.type==Tool.Actions.HIDE&&f();break;case Tool.Actions.MSG_RESIZE:p.onResize();break;case Tool.Actions.MSG_ON_DATA_LOADED:b.vars.dataId==a&&(l=FJ.Application.model.data[a],console.log("_data",l))}}},DirectorsMobile=function(a,b){function c(){f.hide()}var d,e,f=new FJ.View(b),g=ScrollController;f.id(a+"-mobile"),e=new ViewState(a,-1,-1,f,function(b){return b.head==a}),FJ.Application.createMediator().update=function(b){switch(b.message){case FJ.MSG_NAVIGATE:e.onNavigation(b.slug),e.isVisible()?(g.target(f),h()):c();break;case Tool.Actions.MSG_RESIZE:e.onResize();break;case Tool.Actions.V_CNT:case Tool.Actions.SIDENAV:b.type==Tool.Actions.HIDE&&e.isVisible()&&g.target(f);break;case Tool.Actions.MSG_ON_DATA_LOADED:b.vars.dataId==a&&h()}};var h=function(){BaseView.requestData(a,Tool.Actions.V_DIR,Tool.Actions.DT_DIRECTORS)||(FJ.Loader.loadPlainText(Tool.Actions.TP_DIR_MOBILE,function(a){d=new FJ.Template(a),h()}),h=function(){if(d){var c=FJ.Application.model.data[a];h=function(){b.style.background="white",d.execute(f.div,c[e.lastSlug.parts[2]]),f.show(),setTimeout(function(){for(var a=f.div.querySelectorAll(".director"),b=0,c=a.length;b<c;b++)!function(){var c=b;setTimeout(function(){a[c].classList.add("visible")},70*b)}()},300)},h()}})}},DirectorPageMobile=function(a,b){function c(){g.div.innerHTML&&(g.div.innerHTML=""),g.hide()}var d,e,f,g=new FJ.View(b),h=ScrollController;g.id(a+"-mobile"),f=new ViewState(a,-1,-1,g,function(b){return b.head==a}),FJ.Application.createMediator().update=function(a){switch(a.message){case FJ.MSG_NAVIGATE:f.onNavigation(a.slug),f.isVisible()?(i(),h.target(g)):c();break;case Tool.Actions.V_CNT:case Tool.Actions.SIDENAV:a.type==Tool.Actions.HIDE&&f.isVisible()&&h.target(g);break;case Tool.Actions.MSG_RESIZE:f.onResize();break;case Tool.Actions.MSG_ON_DATA_LOADED:e&&a.vars.dataId==e&&i()}};var i=function(){d||FJ.Loader.loadPlainText(Tool.Actions.TP_DIR_PAGE_MOBILE,function(a){d=a,i()}),i=function(){if(b.style.background="black",e=f.lastSlug.parts[1],!BaseView.requestData(e,e,Tool.Actions.DT_DIRECTOR_ITEM+"?s="+e)){var a=FJ.Application.model.data[e];a.subnavi.navi&&(a.subnavi=a.subnavi.navi.slice(1));for(var c=a.bio.content.split("##"),i=c.shift(),j=0,k=c.length;j<k;j++)i+="<p>",i+=c.shift(),i+="</p>";if(a.bio.content=i,console.log("data",a),g.div.innerHTML=_Template(d,a),g.show(),f.lastSlug.parts.length>2){var l=f.lastSlug.parts[2];h.scrollTo(0,document.getElementById(l).offsetTop-80)}}}}},HomeMobile=function(a,b){function c(){if(GlobalBackground.setColor("#000"),!BaseView.requestData(a,Tool.Actions.V_HOME,Tool.Actions.DT_HOME)){if(!j)return void FJ.Loader.loadPlainText(Tool.Actions.TP_HOME_MOBILE,function(a){j=new FJ.Template(a),c()});k=FJ.Application.model.data[a],k.featureImage=location.origin+"/"+location.pathname+"/assets/imgs/home/palme-mobile.jpg",j.execute(s.div,k);var g=s.div.querySelector("img");g.style.height=window.innerHeight+"px",m=new FJ.CSSTransformBehavior(g,{div:g}),new FJ.CSSTransitionBehavior(g,m),m.transition.set("opacity",4e3),m.div.addEventListener("click",function(){window.open("http://lbbonline.com/news/tool-wins-palme-dor-at-cannes-lions-2016/","_blank")}),p=new Vignette(s.div,.1,.8),c=function(){if(l&&clearInterval(l),t.isVisible()){b.style.background="black",s.show();var a=document.getElementById("vplayer");if(a.width=window.innerWidth,a.height=9*a.width/16,a.addEventListener("webkitendfullscreen",f),a.addEventListener("ended",e),n=document.getElementById("play-btn"),o=setInterval(i,100),n.classList.add("down-facing"),setTimeout(function(){n.classList.remove("down-facing")},1),n.addEventListener("click",function(){n.classList.add("down-facing"),d(),setTimeout(function(){clearInterval(l),new FJ.Notification(FJ.MSG_NAVIGATE,FJ.NOTIF_NAVIGATION,n.getAttribute("data-slug")).send()},300)}),"reel"==t.lastSlug.parts[1]){p.hide(),clearTimeout(q),setTimeout(function(){s.div.classList.add("activeVideo")},400);try{d()}catch(a){}}else setTimeout(function(){s.div.classList.add("active")},200),p.show(),s.div.classList.remove("activeVideo"),m.div.style.transform="translateX(-50%)",m.div.style.left="50%",m.div.style.opacity=1,a.pause();window.addEventListener("orientationchange",i)}},c()}}function d(){r=document.getElementById("vplayer"),r.src=getVideoUrl(r.getAttribute("data-href")),r.setAttribute("type",getVideoType());try{r.webkitEnterFullscreen()}catch(a){}r.addEventListener("progress",g),r.load()}function e(){r.webkitExitFullscreen(),f()}function f(){new FJ.Notification(FJ.MSG_NAVIGATE,FJ.NOTIF_NAVIGATION,"home").send()}function g(){r.readyState>0&&(r.removeEventListener("progress",g),r.play())}function h(){window.addEventListener("orientationchange",i),s.div.classList.remove("activeVideo"),s.div.classList.remove("active"),clearInterval(l),r&&(r.removeEventListener("webkitendfullscreen",f),r.removeEventListener("ended",e)),o&&clearInterval(o),s.hide()}function i(){u!=window.innerHeight&&(u=window.innerHeight,p.redraw(),n.parentNode.style.top=window.innerHeight-36-65-10+"px")}var j,k,l,m,n,o,p,q,r,s=new FJ.View(b);s.id(a+"-mobile"),s.class("view");var t=new ViewState(a,-1,-1,s,function(b){return b.head==a||""==b.head});FJ.Application.createMediator().update=function(a){switch(a.message){case FJ.MSG_NAVIGATE:t.onNavigation(a.slug),t.isVisible()?c():h();break;case Tool.Actions.MSG_RESIZE:t.onResize();break;case Tool.Actions.MSG_ON_DATA_LOADED:c()}};var u=0},WorkMobile=function(a,b){function c(){o.target(n),o.onscroll=e,b.style.background="black",m=i.lastSlug.parts[1];var a=Tool.Actions.DT_PROJECT+"?s="+m;if(!BaseView.requestData(m,m,a)){if(!h)return void FJ.Loader.loadPlainText(Tool.Actions.TP_WORK_MOBILE,function(a){h=a,c()});if(j=FJ.Application.model.data[m],j.agency||(j.agency=!1),j.casestudy||(j.casestudy=!1),console.log("data",j),n.div.style.background="#000",j.splashVideo=j.splashVideo||!1,n.div.innerHTML=_Template(h,j),k=document.getElementById("vplayer"),window.addEventListener("orientationchange",g),g(),j.casestudy){n.div.querySelector(".view-additional").addEventListener("click",f)}var d=Modernizr.touch?"touchend":"click";k.addEventListener(d,function(){var a=k.paused;setTimeout(function(){a==k.paused&&k.pause()},100)}),l=document.querySelector("#projectPoster"),l.addEventListener(d,function(){o.scrollTo(0,0),l.style.display="none",k.style.display="block",k.play()}),n.div.classList.remove("visible"),setTimeout(function(){n.div.classList.add("visible");var a=document.querySelector(".title header"),b=new FJ.CSSTransformBehavior(a);new FJ.CSSTransitionBehavior(a,b),b.transform.y(200),b.transform.y(200),setTimeout(function(){b.transform.y(0)},1e3)},300),e(0,0)}}function d(){window.removeEventListener("orientationchange",g),n.div.classList.remove("visible"),n.hide()}function e(a,b){k&&l&&(a>0&&k.paused?(k.style.display="none",l.style.display="block"):k.paused&&l&&k&&(l.style.display="none",k.style.display="block"))}function f(a){k.src==getVideoUrl(j.splashVideo)?(n.div.querySelector(".view-additional").innerHTML="view previous video &#187;",k.src=getVideoUrl(j.casestudy.video)):(n.div.querySelector(".view-additional").innerHTML="view additional video &#187;",k.src=getVideoUrl(j.splashVideo)),k.play()}function g(){if(!k.videoWidth)return void setTimeout(g,100);k.width=window.innerWidth,k.height=9*window.innerWidth/16,k.setAttribute("type",getVideoType())}var h,i,j,k,l,m="",n=new FJ.View(b),o=ScrollController;n.id(a+"-mobile"),i=new ViewState(a,-1,-1,n,function(b){return b.head==a&&2==b.parts.length}),FJ.Application.createMediator().update=function(a){switch(a.message){case FJ.MSG_NAVIGATE:i.onNavigation(a.slug),i.isVisible()?c():d();break;case Tool.Actions.MSG_RESIZE:i.onResize();break;case Tool.Actions.V_CNT:case Tool.Actions.SIDENAV:a.type==Tool.Actions.HIDE&&i.isVisible()&&(o.target(n),o.onscroll=e);break;case Tool.Actions.MSG_ON_DATA_LOADED:a.vars.dataId==m&&c()}}},WorkTagListMobile=function(a,b){function c(){n.target(m),b.style.background="white",l=i.lastSlug.parts[2];var a=Tool.Actions.DT_WORK+"?t="+l;if(!BaseView.requestData(l,l,a)){if(!h)return void FJ.Loader.loadPlainText(Tool.Actions.TP_TAGGED_ITEM,function(a){h=a,c()});if(!g)return void FJ.Loader.loadPlainText(Tool.Actions.TP_WORK_MOBILE,function(a){g=a,c()});j=FJ.Application.model.data[l],console.log("data",j),m.div.style.background="#fff",m.div.innerHTML=_Template(g,{tag:i.lastSlug.parts[2]}),m.show(),f(),k=setInterval(e,100),m.div.classList.remove("visible"),setTimeout(function(){m.div.classList.add("visible")},300),g=void 0}}function d(){clearInterval(k),m.div.classList.remove("visible"),m.hide()}function e(){for(var a=document.querySelectorAll(".project"),b=parseInt(a[0].parentNode.offsetHeight),c=n.getScrollPos().y*n.getScrollSpeed()+65-.75*b,d=c+window.innerHeight+.5*b,e=0,f=a.length;e<f;e++){var g=a[e],h=b*(e+1);h<d&&h>c?g.classList.contains("front-facing")||(g.classList.remove("down-facing"),g.classList.remove("up-facing"),h<c+.5*window.innerHeight?g.classList.add("up-facing"):g.classList.add("down-facing"),function(){var b=a[e];setTimeout(function(){b.classList.remove("down-facing"),b.classList.remove("up-facing"),b.classList.add("front-facing")},10)}()):(g.classList.remove("front-facing"),h<c+.5*window.innerHeight?g.classList.add("up-facing"):g.classList.add("down-facing"))}}function f(){function a(a){console.log("pageNavBy.pageNavBy()",arguments);var b=i.lastSlug.parts.slice(0,3);b.push(parseInt(c)+parseInt(a)),new FJ.Notification(FJ.MSG_NAVIGATE,FJ.NOTIF_NAVIGATION,"/"+b.join("/")).send()}var b=10,c=i.lastSlug.parts[3]||1,d=(c-1)*b,e=Math.min(c*b,j.projects.length),f=j.projects.slice(d,e);m.div.innerHTML+=_Template(h,{projects:f});for(var g=document.querySelectorAll(".project .poster"),k=0,l=g.length;k<l;k++)g[k].style.width=window.innerWidth+"px",g[k].style.height=.58*window.innerWidth+"px",g[k].style.backgroundImage="url('"+g[k].getAttribute("data-src")+"')",g[k].style.backgroundColor="gray",g[k].parentNode.classList.add("loaded");var n=document.createElement("div");n.className="ticks",console.log("data.projects.length/projectCount",j.projects.length/b);for(var k=0,l=j.projects.length/b;k<l;k++){var o=document.createElement("div");o.className="tick",n.appendChild(o)}n.childNodes[c-1].classList.add("current");var p=document.createElement("div");p.id="work-nav",p.appendChild(n);var q=Modernizr.touch?"touchend":"click";if(1!=c){var r=document.createElement("a");r.className="arrow left",r.innerHTML="prev",r.addEventListener(q,function(){a(-1)}),p.appendChild(r)}if(c<j.projects.length/b){var s=document.createElement("a");s.className="arrow right",s.innerHTML="next",s.addEventListener(q,function(){a(1)}),p.appendChild(s)}m.div.appendChild(p),setTimeout(function(){n.style.marginLeft=.5*(window.innerWidth-n.offsetWidth)+"px"},1e3)}var g,h,i,j,k,l="",m=new FJ.View(b),n=ScrollController;m.id(a+"-mobile"),i=new ViewState(a,-1,-1,m,function(b){return b.head==a&&"tag"==b.parts[1]}),FJ.Application.createMediator().update=function(a){switch(a.message){case FJ.MSG_NAVIGATE:i.onNavigation(a.slug),i.isVisible()?(m.div.innerHTML="",m.hide(),d(),setTimeout(c,1e3)):d();break;case Tool.Actions.MSG_RESIZE:i.onResize();break;case Tool.Actions.V_CNT:case Tool.Actions.SIDENAV:a.type==Tool.Actions.HIDE&&i.isVisible()?(n.target(m),k=setInterval(e,100)):clearInterval(k);break;case Tool.Actions.MSG_ON_DATA_LOADED:a.vars.dataId==l&&c()}}},ScrollController=new function(){function a(a){var b=Math.max(0,d.div.offsetHeight-window.innerHeight);e.limitY(0,b/g),d.transform.y(-a.scrollY*g),h=a.scrollY,f.onscroll(a.scrollY,b)}function b(a){}function c(){var a=document.querySelector("#rootView");if(!a)return void setTimeout(c,200);a.style.height=window.screen.availHeight+"px"}var d,e,f=this,g=1,h=0;this.target=function(b){if(void 0==b)return d=void 0,void e.dispatcher.removeEventListener(a);e&&e.dispatcher.removeEventListener(a),e=new FJ.VirtualScroll("vscroll",.1),e.dispatcher.addEventListener(a),d=b,e.setValue(0,-d.transform.y||0),f.onscroll=function(){},f.scrollTo=e.scrollTo},this.onscroll=function(){},this.getScrollSpeed=function(){return g},this.getScrollPos=function(){return{x:0,y:h}},this.disableTouchMove=function(){document.body.addEventListener("touchmove",b,!1),document.querySelector("#rootView").addEventListener("touchmove",b,!1),c(),setInterval(function(){scrollTo(0,0)},3e3)}},Vignette=function(a,b,c){function d(){g=f.getContext("2d");var a=f.width=window.innerWidth,d=f.height=window.innerHeight,h=a*b,i=a*c,j=g.createRadialGradient(a/2,d/2,h,a/2,d/2,i);g.clearRect(0,0,a,d),g.rect(0,0,a,d),j.addColorStop(0,"rgba(0,0,0,0)"),j.addColorStop(1,"rgba(0,0,0,"+e+")"),g.fillStyle=j,g.fill()}var e=.9,f=document.createElement("canvas"),g=f.getContext("2d");b=b||.2,c=c||.5,this.hide=function(){f.style.display="none"},this.show=function(){f.style.display="block"},f.className="vignette",f.style.position="absolute",a.appendChild(f),this.redraw=d,window.addEventListener("resize",d),d()};
//# sourceMappingURL=mobile_min.map